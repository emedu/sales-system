# 04_開發問答與學習筆記

## Q1: 為什麼 Prisma 初始化會失敗？
**狀況**: 執行 `npx prisma init` 後，Seeding 腳本無法找到 Client，報錯 `Error: Cannot find module`。
**原因**: Prisma v7.1.0 引入了新的 Config 載入機制，與舊版開發習慣不同，且在某些環境下不穩定。
**解決**: 果斷降級回 **Prisma v5**，這是目前最穩定且廣泛使用的版本。

## Q2: 如何跨裝置同步資料庫？
**狀況**: 使用 SQLite (`dev.db`) 雖然方便，但 `.gitignore` 通常會排除它。
**解決**: 
1. **開發環境**: 每次拉取程式碼後，執行 `npx prisma db push` 重新產生本地資料庫，並用 seeds 填入假資料。
2. **正式環境**: `dev.db` 應定期備份，或考慮遷移至 PostgreSQL (若需多人同時寫入)。

## Q3: 為什麼要用 Sonner 取代 Toaster？
**狀況**: 原始 Shadcn 安裝指令預設的 Toaster 在新版 React/Next.js 可能會有 Hydration 警告。
**解決**: Sonner 是目前社群推薦的輕量化替代方案，API 更簡潔 (`toast.success()`)。

## Q4: 什麼是「Context A (新電腦)」與「Context B (日常維運)」？
**狀況**: 用戶對於協定中的「情境 A (Onboarding)」與「情境 B (Daily Workflow)」提出疑問。
**解釋**:
- **情境 A (新電腦/移交)**: 指的是當開發者拿到一台全新的電腦，或新進同事要接手專案時。此時電腦是空的，必須執行完整的「復活」流程 (`git clone` -> `npm install` -> `npm run dev`)。
- **情境 B (日常維運)**: 指的是在這台已經設定好環境的電腦上繼續工作。此時只需要 `npm run dev` 即可開始獲得產出，無需重新安裝依賴。
- **現況**: 目前這台電腦處於 **情境 B** (環境已備妥)，隨時可進行開發或演示。

## Q5: 銷售漏斗追蹤系統的設計需求是什麼？(2025/12/21)
**背景**: 原本的系統只有「成交回報」功能,缺乏完整的銷售流程追蹤機制。

**核心需求 (2025/12/21 更新)**:
1. **4 階段漏斗統計**:
   - 區分成功與失敗狀態 (如: 聯繫成功 vs 聯繫失敗)
   - 統計各階段轉換率

2. **資料同步策略**:
   - **自動同步**: 學號、姓名、首次接待人 (從總表同步)
   - **手動維護**: 主洽課程 (不自動同步,由諮詢師判斷後選擇)

3. **主洽課程欄位 (12 大類)**:
   - 美丙, 美乙, 髮丙, 造型, 美甲, 紋繡, SPA, 除毛, 美睫, 刺青, 美醫, 個彩

4. **當前階段欄位 (數字+文字)**:
   - 格式: "數字. 狀態文字"
   - 狀態:
     - 1. 首次洽詢
     - 2.1 聯繫成功 / 2.2 聯繫失敗
     - 3.1 邀約成功 / 3.2 邀約失敗
     - 4.1 到訪成功 / 4.2 未到訪
     - 5. 成交

**技術決策**:
- 後端 API 已完整實作 (5 個端點)
- Google Sheets「流程追蹤」工作表已建立 (20 欄位)
- 前端介面待開發 (漏斗視覺化、階段更新表單)

**參考資料**:
- 總表 ↔ 成交率分析表的公式同步機制
- 成交率分析表的課程類別下拉選單設定
